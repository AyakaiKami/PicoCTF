<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>asm1_WR</title>
</head>
<body>
    <div style="display: flex;flex-direction: column;align-items:center;
    justify-content: center;font-size: large">
        <h1>Description</h1>
        <a>What does asm1(0x2e0) return? Submit the flag as a hexadecimal value (starting with '0x').
            <br> NOTE: Your submission for this question will NOT be in the normal flag format. Source</a> 
            <br>
        <div style="display: flex;flex-direction: column;align-items:center;
        justify-content: center;font-size: larger;">
        Let's look at the file.
        <br>
        <img src="wr1.png" width="50%" height="50%">
        As we can see,it's assembley:).
        <br>
        Fun fact about me,I am in love with assembley and I would much rather write in asm than in python.
        <br>
        Joke aside,let's try to understand the code.I will use this to solve this CTF:
        <a href="https://www.tutorialspoint.com/assembly_programming/index.htm">this</a>
        <br>
        We know that the result of a function will be in eax.
        Let's take asm1 as a function and 0x2e0 as its parameter.Before we call that function,
        0x2e0 goes on the stack.
        We know the stack pointer goes down,So we can try to imagine the stack:
        <br>
        Stack:
        <br>
        old ebp     //where esp should point to
        <br>
        return address
        <br>
        0x2e0      //param of the function
        <br>
        So with the "mov ebp,esp" operation ebp will point to the old ebp/current esp.That means that
        DWORD PTR [ebp+0x8] will point to 0x2e0.
        <br>
        Let's check the first cmp,it compares 0x2e0 with 0x3fb.The jump happens only if 0x2e0 > 0x3fb which is false.
        <br>
        The second cmp compares 0x2e0 with 0x280.The jump happens if the 2 values are not equal and that's true.
        <br>
        We jumped on line 29 and we can see we move 0x2e0 in eax.
        Next line subtracts 10 from eax. Eax becomes 0x2d6.
        We jump on line 60 where we prepare to return to the main function.
        On line 61 we have the return call.
        <br>
        Eax is 0x2d6.
        <h2>Flag : 0x2d6</h2>
        </div>
    </div>
</body>
</html>